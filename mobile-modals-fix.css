/**
 * Mobile Modals & Viewers - Complete Fix
 * ========================================
 * Fixes ALL modal interfaces on mobile:
 * - CV Viewer
 * - GitHub File Browser
 * - Project CW/HW/Solo viewers
 * - 3D Model viewers
 * - Image galleries
 * - All popup interfaces
 */

/* ========================================
   CV VIEWER - MOBILE FIX
   ======================================== */

@media (max-width: 768px) {
    /* CV Container - Full screen mobile */
    body.cv-viewer-open {
        overflow: hidden !important;
    }

    .cv-controls {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        height: auto !important;
        min-height: 60px !important;
        padding: 10px 15px !important;
        flex-direction: column !important;
        gap: 10px !important;
        z-index: 10000 !important;
    }

    .cv-title {
        width: 100% !important;
        flex-direction: column !important;
        align-items: flex-start !important;
        gap: 8px !important;
    }

    .cv-icon {
        width: 35px !important;
        height: 35px !important;
        font-size: 1.2rem !important;
    }

    .cv-title h1 {
        font-size: 1.1rem !important;
        line-height: 1.3 !important;
    }

    .cv-title p {
        font-size: 0.8rem !important;
        display: none !important; /* Hide subtitle on small screens */
    }

    .cv-actions {
        width: 100% !important;
        flex-wrap: wrap !important;
        gap: 8px !important;
        justify-content: flex-start !important;
    }

    .cv-btn {
        padding: 10px 16px !important;
        font-size: 0.85rem !important;
        min-height: 44px !important;
        flex: 1 !important;
        min-width: 120px !important;
        justify-content: center !important;
    }

    .cv-btn i {
        font-size: 1rem !important;
    }

    /* CV Viewer Container */
    #cv-viewer-container {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        width: 100% !important;
        height: 100% !important;
        padding-top: 140px !important; /* Space for controls */
        padding-bottom: 0 !important;
        overflow: hidden !important;
    }

    /* PDF Embed */
    #cv-pdf-embed {
        width: 100% !important;
        height: calc(100vh - 140px) !important;
        border: none !important;
    }

    /* Loading State */
    .cv-loading {
        padding: 60px 20px !important;
        font-size: 1rem !important;
    }

    .cv-loading i {
        font-size: 2.5rem !important;
        margin-bottom: 20px !important;
    }
}

/* ========================================
   GITHUB FILE BROWSER - MOBILE FIX
   ======================================== */

@media (max-width: 768px) {
    /* Browser Modal */
    #github-browser-modal {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        width: 100% !important;
        height: 100% !important;
        z-index: 10000 !important;
        background: rgba(0, 0, 0, 0.95) !important;
        overflow: hidden !important;
    }

    .browser-modal-content {
        position: absolute !important;
        top: 0 !important;
        left: 0 !important;
        width: 100% !important;
        height: 100% !important;
        max-width: 100% !important;
        max-height: 100% !important;
        margin: 0 !important;
        padding: 0 !important;
        border-radius: 0 !important;
        background: linear-gradient(135deg, #0a0a0a 0%, #1a0000 100%) !important;
        display: flex !important;
        flex-direction: column !important;
    }

    /* Browser Header */
    .browser-header {
        padding: 12px 15px !important;
        min-height: 60px !important;
        flex-shrink: 0 !important;
        border-bottom: 2px solid rgba(255, 0, 0, 0.3) !important;
    }

    .browser-header h2 {
        font-size: 1.1rem !important;
        line-height: 1.3 !important;
        margin-bottom: 8px !important;
    }

    /* Breadcrumb */
    .browser-breadcrumb {
        flex-wrap: wrap !important;
        gap: 6px !important;
        font-size: 0.75rem !important;
        padding: 8px 0 !important;
    }

    .breadcrumb-item {
        max-width: 120px !important;
        overflow: hidden !important;
        text-overflow: ellipsis !important;
        white-space: nowrap !important;
    }

    .breadcrumb-separator {
        margin: 0 4px !important;
    }

    /* Browser Body */
    .browser-body {
        flex: 1 !important;
        overflow-y: auto !important;
        -webkit-overflow-scrolling: touch !important;
        padding: 15px !important;
    }

    /* File List */
    .browser-files {
        display: flex !important;
        flex-direction: column !important;
        gap: 10px !important;
    }

    .file-item {
        padding: 14px 16px !important;
        min-height: 56px !important;
        border-radius: 10px !important;
        display: flex !important;
        align-items: center !important;
        gap: 12px !important;
        background: linear-gradient(135deg, rgba(30, 0, 0, 0.5), rgba(10, 0, 0, 0.3)) !important;
        border: 1px solid rgba(255, 0, 0, 0.2) !important;
        cursor: pointer !important;
        transition: all 0.2s ease !important;
    }

    .file-item:active {
        transform: scale(0.98) !important;
        border-color: rgba(255, 0, 0, 0.5) !important;
        background: linear-gradient(135deg, rgba(40, 0, 0, 0.6), rgba(20, 0, 0, 0.4)) !important;
    }

    .file-icon {
        font-size: 1.5rem !important;
        width: 36px !important;
        height: 36px !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        flex-shrink: 0 !important;
    }

    .file-info {
        flex: 1 !important;
        min-width: 0 !important;
    }

    .file-name {
        font-size: 0.95rem !important;
        font-weight: 600 !important;
        color: #ffffff !important;
        margin-bottom: 4px !important;
        overflow: hidden !important;
        text-overflow: ellipsis !important;
        white-space: nowrap !important;
    }

    .file-size {
        font-size: 0.75rem !important;
        color: rgba(255, 255, 255, 0.6) !important;
    }

    /* Action Buttons */
    .file-actions {
        display: flex !important;
        gap: 8px !important;
        flex-shrink: 0 !important;
    }

    .file-action-btn {
        width: 40px !important;
        height: 40px !important;
        min-width: 40px !important;
        padding: 0 !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        border-radius: 8px !important;
        font-size: 1rem !important;
    }

    /* Close Button */
    .browser-close,
    .modal-close {
        position: absolute !important;
        top: 12px !important;
        right: 12px !important;
        width: 44px !important;
        height: 44px !important;
        font-size: 1.5rem !important;
        z-index: 10001 !important;
        background: rgba(255, 0, 0, 0.2) !important;
        border: 1px solid rgba(255, 0, 0, 0.4) !important;
        border-radius: 50% !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        color: #ffffff !important;
        cursor: pointer !important;
    }

    .browser-close:active,
    .modal-close:active {
        transform: scale(0.9) !important;
        background: rgba(255, 0, 0, 0.4) !important;
    }

    /* Loading State */
    .browser-loading {
        padding: 60px 20px !important;
        text-align: center !important;
    }

    .browser-loading i {
        font-size: 3rem !important;
        margin-bottom: 20px !important;
    }

    /* Empty State */
    .browser-empty {
        padding: 60px 20px !important;
        text-align: center !important;
    }
}

/* ========================================
   SOLIDWORKS CW/HW/SOLO VIEWERS - MOBILE
   ======================================== */

@media (max-width: 768px) {
    /* SW Card Views */
    .sw-view {
        padding: 15px !important;
    }

    .sw-view-header {
        padding: 12px 15px !important;
        flex-direction: column !important;
        align-items: flex-start !important;
        gap: 10px !important;
        background: linear-gradient(135deg, rgba(30, 0, 0, 0.6), rgba(10, 0, 0, 0.4)) !important;
        border-radius: 10px !important;
        margin-bottom: 15px !important;
    }

    .sw-view-header h4 {
        font-size: 1.1rem !important;
        width: 100% !important;
    }

    .sw-back {
        width: 100% !important;
        padding: 10px 16px !important;
        min-height: 44px !important;
        font-size: 0.95rem !important;
        justify-content: center !important;
        margin-bottom: 10px !important;
    }

    .folder-link {
        width: 100% !important;
        padding: 10px 16px !important;
        min-height: 44px !important;
        text-align: center !important;
        display: block !important;
    }

    /* Files Wrap */
    .sw-files-wrap {
        padding: 0 !important;
    }

    /* Day Folders */
    .sw-day-folder {
        margin-bottom: 20px !important;
        background: linear-gradient(135deg, rgba(30, 0, 0, 0.4), rgba(10, 0, 0, 0.2)) !important;
        border: 1px solid rgba(255, 0, 0, 0.2) !important;
        border-radius: 12px !important;
        padding: 15px !important;
    }

    .sw-day-title {
        font-size: 1rem !important;
        padding: 10px 0 !important;
        margin-bottom: 12px !important;
    }

    .sw-file-list {
        display: flex !important;
        flex-direction: column !important;
        gap: 10px !important;
    }

    .sw-file-item {
        padding: 12px 14px !important;
        min-height: 52px !important;
        border-radius: 8px !important;
        background: rgba(255, 255, 255, 0.03) !important;
        border: 1px solid rgba(255, 255, 255, 0.1) !important;
    }

    .sw-file-item:active {
        background: rgba(255, 255, 255, 0.08) !important;
        border-color: rgba(255, 0, 0, 0.4) !important;
        transform: scale(0.98) !important;
    }

    .sw-file-name {
        font-size: 0.9rem !important;
        margin-bottom: 6px !important;
    }

    .sw-file-actions {
        flex-wrap: wrap !important;
        gap: 6px !important;
    }

    .sw-file-btn {
        padding: 6px 12px !important;
        font-size: 0.8rem !important;
        min-height: 36px !important;
        flex: 1 !important;
        min-width: 80px !important;
    }
}

/* ========================================
   3D MODEL VIEWER - MOBILE
   ======================================== */

@media (max-width: 768px) {
    model-viewer {
        width: 100% !important;
        height: 300px !important;
        min-height: 300px !important;
        max-height: 50vh !important;
        border-radius: 12px !important;
        background: rgba(0, 0, 0, 0.3) !important;
    }

    .model-viewer-container {
        margin: 15px 0 !important;
        border-radius: 12px !important;
        overflow: hidden !important;
    }

    /* Model controls */
    .model-controls {
        display: flex !important;
        flex-wrap: wrap !important;
        gap: 8px !important;
        padding: 12px !important;
        background: rgba(0, 0, 0, 0.3) !important;
        border-radius: 0 0 12px 12px !important;
    }

    .model-control-btn {
        flex: 1 !important;
        min-width: 100px !important;
        padding: 10px !important;
        min-height: 44px !important;
        font-size: 0.85rem !important;
    }
}

/* ========================================
   IMAGE GALLERY/PREVIEW - MOBILE
   ======================================== */

@media (max-width: 768px) {
    .image-preview-modal {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        width: 100% !important;
        height: 100% !important;
        background: rgba(0, 0, 0, 0.98) !important;
        z-index: 10000 !important;
        display: flex !important;
        flex-direction: column !important;
    }

    .preview-header {
        padding: 12px 15px !important;
        background: rgba(10, 10, 10, 0.9) !important;
        border-bottom: 1px solid rgba(255, 0, 0, 0.3) !important;
    }

    .preview-image-container {
        flex: 1 !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        padding: 20px !important;
        overflow: hidden !important;
    }

    .preview-image {
        max-width: 100% !important;
        max-height: 100% !important;
        object-fit: contain !important;
        border-radius: 8px !important;
    }

    .preview-controls {
        padding: 15px !important;
        background: rgba(10, 10, 10, 0.9) !important;
        border-top: 1px solid rgba(255, 0, 0, 0.3) !important;
        display: flex !important;
        gap: 10px !important;
        justify-content: space-around !important;
    }

    .preview-btn {
        flex: 1 !important;
        padding: 12px !important;
        min-height: 48px !important;
        font-size: 0.9rem !important;
    }
}

/* ========================================
   PDF/DOCUMENT VIEWER - MOBILE
   ======================================== */

@media (max-width: 768px) {
    .pdf-viewer-modal {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        width: 100% !important;
        height: 100% !important;
        z-index: 10000 !important;
        background: #000000 !important;
    }

    .pdf-viewer-header {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        padding: 12px 15px !important;
        background: rgba(10, 10, 10, 0.95) !important;
        border-bottom: 1px solid rgba(255, 0, 0, 0.3) !important;
        z-index: 10001 !important;
        display: flex !important;
        align-items: center !important;
        justify-content: space-between !important;
    }

    .pdf-viewer-title {
        font-size: 0.95rem !important;
        flex: 1 !important;
        margin-right: 10px !important;
        overflow: hidden !important;
        text-overflow: ellipsis !important;
        white-space: nowrap !important;
    }

    .pdf-viewer-body {
        position: absolute !important;
        top: 60px !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        overflow: auto !important;
        -webkit-overflow-scrolling: touch !important;
    }

    .pdf-embed,
    iframe.pdf-viewer {
        width: 100% !important;
        height: 100% !important;
        border: none !important;
    }
}

/* ========================================
   SOLIDWORKS MODE SWITCH - MOBILE
   ======================================== */

@media (max-width: 768px) {
    .sw-mode-switch {
        display: flex !important;
        flex-wrap: nowrap !important;
        overflow-x: auto !important;
        -webkit-overflow-scrolling: touch !important;
        gap: 8px !important;
        padding: 12px 15px !important;
        margin: 0 -15px !important;
        scrollbar-width: none !important;
    }

    .sw-mode-switch::-webkit-scrollbar {
        display: none !important;
    }

    .sw-mode-btn {
        flex: 1 !important;
        min-width: 100px !important;
        padding: 10px 16px !important;
        min-height: 44px !important;
        font-size: 0.85rem !important;
        white-space: nowrap !important;
        border-radius: 10px !important;
        background: rgba(255, 255, 255, 0.05) !important;
        border: 1px solid rgba(255, 255, 255, 0.15) !important;
        color: rgba(255, 255, 255, 0.8) !important;
        transition: all 0.2s ease !important;
    }

    .sw-mode-btn[aria-current="true"],
    .sw-mode-btn.active {
        background: linear-gradient(135deg, rgba(255, 0, 0, 0.3), rgba(200, 0, 0, 0.2)) !important;
        border-color: rgba(255, 0, 0, 0.6) !important;
        color: #ffffff !important;
        box-shadow: 0 4px 15px rgba(255, 0, 0, 0.3) !important;
    }

    .sw-mode-btn:active {
        transform: scale(0.95) !important;
    }
}

/* ========================================
   QUICK ACTIONS - MOBILE
   ======================================== */

@media (max-width: 768px) {
    .sw-quick-actions {
        display: flex !important;
        flex-direction: column !important;
        gap: 10px !important;
        margin: 15px 0 !important;
    }

    .btn-sw-browse,
    .btn-sw-download {
        width: 100% !important;
        padding: 12px 20px !important;
        min-height: 48px !important;
        font-size: 0.95rem !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        gap: 10px !important;
        border-radius: 10px !important;
        font-weight: 600 !important;
            transition: all 0.3s ease !important;
    }

        /* Browse Files Button - Calm standout */
        .btn-sw-browse {
            background: linear-gradient(135deg, rgba(60, 0, 0, 0.8), rgba(40, 0, 0, 0.7)) !important;
            border: 2px solid rgba(255, 0, 0, 0.6) !important;
            color: #ffffff !important;
            font-weight: 700 !important;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.45) !important;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.7) !important;
            position: relative !important;
            overflow: hidden !important;
        }
    
        .btn-sw-browse::before { display: none !important; }

        .btn-sw-browse:active {
            background: linear-gradient(135deg, rgba(80, 0, 0, 0.85), rgba(50, 0, 0, 0.75)) !important;
            transform: scale(0.985) !important;
            box-shadow: 0 8px 18px rgba(0, 0, 0, 0.5) !important;
        }

    .btn-sw-download {
        background: linear-gradient(135deg, #ff0000, #cc0000) !important;
        color: #ffffff !important;
        box-shadow: 0 4px 15px rgba(255, 0, 0, 0.3) !important;
    }

    .btn-sw-download:active {
        background: linear-gradient(135deg, #ff3333, #ff0000) !important;
        transform: scale(0.98) !important;
    }
}

/* ========================================
   GENERAL MODAL FIXES
   ======================================== */

@media (max-width: 768px) {
    /* Prevent body scroll when modal open */
    body.modal-open {
        overflow: hidden !important;
        position: fixed !important;
        width: 100% !important;
    }

    /* All modals base */
    .modal,
    [role="dialog"],
    [aria-modal="true"] {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        width: 100% !important;
        height: 100% !important;
        z-index: 10000 !important;
    }

    /* Smooth transitions */
    .modal {
        transition: opacity 0.3s ease !important;
    }

    /* Touch scrolling */
    .modal-body,
    .modal-content,
    .browser-body {
        -webkit-overflow-scrolling: touch !important;
    }
}

/* ========================================
   LANDSCAPE MODE ADJUSTMENTS
   ======================================== */

@media (max-width: 768px) and (orientation: landscape) {
    .cv-controls {
        flex-direction: row !important;
        height: 60px !important;
        padding: 10px 15px !important;
    }

    .cv-title {
        flex-direction: row !important;
        align-items: center !important;
    }

    .cv-actions {
        width: auto !important;
    }

    #cv-viewer-container {
        padding-top: 70px !important;
    }

    #cv-pdf-embed {
        height: calc(100vh - 70px) !important;
    }

    model-viewer {
        height: 60vh !important;
    }
}

/* ========================================
   ACCESSIBILITY
   ======================================== */

@media (max-width: 768px) {
    /* Focus visible */
    .file-item:focus-visible,
    .sw-file-item:focus-visible,
    .sw-mode-btn:focus-visible {
        outline: 3px solid rgba(255, 0, 0, 0.6) !important;
        outline-offset: 2px !important;
    }

    /* Reduce motion */
    @media (prefers-reduced-motion: reduce) {
        .modal,
        .file-item,
        .sw-file-item {
            transition: none !important;
        }
    }
}
